(function(l,h){var k,g,m=/^\/+|\/+$/g,i=function(a){return(a||"").replace(m,"")},n=/\/+$/g,o=/^(\s|\u00A0)+|(\s|\u00A0)+$/g,j=typeof String.trim==="function"?String.trim:function(a){return(a||"").replace(o,"")};k=function(a,c){this.uri=new g(a);this.settings=c};g=function(a){this.segments=a;if(typeof a==="string"){this.segments={};this.segments.root=a}if(!this.segments.root)throw{name:"missing argument",message:"root is not specified"};};g.prototype.parse=function(a){var c,b,d,f,e=this.segments.root;
c=new g(e);a=a.split("?");if(a.length>2)throw{name:"invalid input",message:"uri is not valid, to many ? in the uri"};d=a[1];b=a[0].toUpperCase();e=e.toUpperCase();if(b.indexOf(e)===0)b=a[0].slice(e.length);else if((f=b.indexOf(e))>0)b=a[0].slice(e.length+f);else{f=0;do{e=e.slice(1);f+=1}while(e.length>0&&b.indexOf(e)!==0);b=a[0].slice(e.length)}a=b.split("/$value");if(a.length===2)c.segments.value=true;b=a[0];a=b.split("/$count");if(a.length===2)c.segments.count=true;b=a[0];if(!c.segments.value&&
(a=b.split("/$links/")).length===2){c.segments.resource=i(j(a[0]));c.segments.links=a[1]}else c.segments.resource=i(j(b));if(d!==h&&d.length>0){a=d.split("&");if(e=a.length)c.segments.options={};d=c.segments.options;for(f=0;f<e;f+=1){b=a[f].split("=");switch(b[0]){case "$orderby":d.orderby=b[1];break;case "$top":d.top=parseInt(b[1],10);break;case "$skip":d.skip=parseInt(b[1],10);break;case "$filter":d.filter=b[1];break;case "$expand":d.expand=b[1];break;case "$select":d.select=b[1];break;case "$skiptoken":d.skiptoken=
b[1];break;case "$inlinecount":d.inlinecount=b[1]==="allpages";break;case "$format":d.format=b[1];break;default:if(!d.params)d.params={};d.params[b[0]]=b[1];break}}}return c};g.prototype.stringify=function(){var a,c,b,d=false,f,e="";c=this.segments;a=c.options;if(!c.root)return"";f=c.resource||"";if(c.links)f+="/$links/"+i(c.links);if(c.count)f+="/$count";else if(c.value)f+="/$value";for(b in a)if(b!==h&&a[b]!==null)switch(b){case "params":for(b in a.params)if(b!==h){if(d)e+="&";e+=b+"="+a.params[b];
d=true}break;case "inlinecount":if(a.inlinecount){if(d)e+="&";e+="$inlinecount=allpages";d=true;break}break;case "format":if(a[b]==="json"&&(c.count||c.value))break;case "callback":case "orderby":case "top":case "skip":case "filter":case "expand":case "select":case "skiptoken":if(d)e+="&";e+="$"+b+"="+a[b];d=true;break}this.uri=(j(c.root)||"").replace(n,"");this.uri+=f!==""?"/"+f:"";this.uri+=e!==""?"?"+e:"";return this.uri};l.oData=function(a,c){return new k(a,c)}})(window);
